## [Grakn Forces 2020](https://codeforces.com/contest/1408/)

### D：二维处理问题，经典重要问题

> 一开始没有看数据范围觉得没法过，就没想这个问题，然后狮子大张口想做最后一题...


此问题可以转换成经典问题：二维平面，第一象限的 $n$ 个点，每次只能同时向左或者向下移动一个单位，问最少需要多少步，让所有的点都不在第一象限。
首先先对一个坐标（例如横坐标）进行从小到大排序，然后最终结果就是 第 i 个点的横坐标加上后面所有点的纵坐标的最大值，这 n + 1 个结果中最小的一个！

### F：脑筋急转弯问题

读完题目我就知道对于 $n$ 为 2 的幂次时，可以让所有元素一致，但是后面怎么就没有想到前后各搞一次呢？我在干什么！！！


### I

> 本题解基于 Soulist 的题解和 Jiangly 的代码，写这个的原因是这个题我是非常想搞清楚，然后只有转化成自己的语言才能弄清楚，所以想写下来，从而说明是真的理解了。

题意：给定 $n$ 个数 ($a_1, a_2, \cdots, a_n$)，（序列元素互异，但是这个条件没啥用吧）每次操作为等概率的选择其中一个数，然后将其减一，问经过 $k$ 次操作之后这 $n$ 个数的异或和 为 $x = 0, 1, \cdots, 2^c - 1$ 的概率。

其中， $k, c \leq 16, a_i \in [k, 2^c)$，最后答案是分数，在模 998244353 的意义下就是个整数啦。

- 令 $sa = a_1 \oplus a_2 \cdots \oplus a_n$，然后考虑答案在 $t$ 上的改变量。
- 令 $d_{i,j} = a_i \oplus (a_i - j)$，$\displaystyle F(x, y) = \prod_{i = 1}^n \left( \sum_{j = 0}^k \frac{x^{d_{i,j}}}{j!} y^j \right)$ 那么我们的答案就是 $F(x,y)[y^k] \cdot k!$，其中 $x$ 上是异或卷积，$y$ 上的是普通卷积。

那么我们现在主要问题就变成如何就 $F(x,y)[y^k] \cdot k!$ 了。由于 $x$ 上的系数加法是异或加法，所以我们需要用 [异或的 fwt](https://oi-wiki.org/math/poly/fwt/) 将它转化成普通乘法。

- $x$ 上的系数可以本质是下标！下标对应的值是关于$y$的多项式，首先注意到做 fwt 仅仅是将 $x$ 上的系数做了改变，并没有改变其它内容。这样做是为了把卷积异或乘法改成普通卷积乘法。这里做 fwt 的时候可以暴力搞。
- 优化 1：仅有 $O(ck)$ 中 $k$ 元组
- 每个 $k$ 元组对应的下标对应 fwt 之后的编号只有 $2^k$ 种！
- 多项式乘法可以用 `ln/exp` 来运算

soulist 写了[题解](https://www.cnblogs.com/Soulist/p/13758388.html)
以下是 [jiangly 大佬的代码](https://codeforces.com/contest/1408/submission/94346776) 的注释版。
